{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Smert/OneDrive/Masa\\xFCst\\xFC/react_shop/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Smert/OneDrive/Masa\\xFCst\\xFC/react_shop/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{resetCart}from\"../../redux/cartReducer\";import{makeRequest}from\"../../makeRequest\";import{loadStripe}from\"@stripe/stripe-js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Payment=function Payment(){var dispatch=useDispatch();var products=useSelector(function(state){return state.cart.products;});var totalPrice=function totalPrice(){var total=0;products.forEach(function(item){item.sale?total+=item.quantity*item.price*0.8:total+=item.quantity*item.price;});return total.toFixed(2);};var stripePromise=loadStripe(\"pk_test_51Nj8vADRdzzh1Z4QYGEKVxQO12ZZFgATugRlwwZdyXIRiG2UpFsLIm09WcaDIWxmhYBZeYhkJLTrV0OT4yCd0EzN00BD6JwrFk\");var handlePayment=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var stripe,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return stripePromise;case 3:stripe=_context.sent;_context.next=6;return makeRequest.post(\"/orders\",{products:products});case 6:res=_context.sent;_context.next=9;return stripe.redirectToCheckout({sessionId:res.data.stripeSession.id});case 9:_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 14:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));return function handlePayment(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"total flex justify-between font-medium text-lg mb-5\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"SUBTOTAL\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",totalPrice()]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"w-44 py-3 bg-blue-500 text-white  flex justify-center items-center gap-3 cursor-pointer font-medium text-xs mb-3 hover:bg-blue-600 duration-200\",onClick:handlePayment,children:\"PROCEED TO CHECKOUT\"}),/*#__PURE__*/_jsx(\"span\",{className:\"reset text-red-500 text-xs cursor-pointer hover:text-red-600\",onClick:function onClick(){return dispatch(resetCart());},children:\"Reset Cart\"})]});};export default Payment;","map":{"version":3,"names":["React","useDispatch","useSelector","resetCart","makeRequest","loadStripe","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Payment","dispatch","products","state","cart","totalPrice","total","forEach","item","sale","quantity","price","toFixed","stripePromise","handlePayment","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","stripe","res","wrap","_callee$","_context","prev","next","sent","post","redirectToCheckout","sessionId","data","stripeSession","id","t0","console","log","stop","apply","arguments","children","className","onClick"],"sources":["C:/Users/Smert/OneDrive/Masaüstü/react_shop/client/src/components/CartCard/Payment.jsx"],"sourcesContent":["import React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { resetCart } from \"../../redux/cartReducer\";\r\nimport { makeRequest } from \"../../makeRequest\";\r\nimport { loadStripe } from \"@stripe/stripe-js\";\r\n\r\nconst Payment = () => {\r\n  const dispatch = useDispatch();\r\n  const products = useSelector((state) => state.cart.products);\r\n\r\n  const totalPrice = () => {\r\n    let total = 0;\r\n    products.forEach((item) => {\r\n      item.sale\r\n        ? (total += item.quantity * item.price * 0.8)\r\n        : (total += item.quantity * item.price);\r\n    });\r\n    return total.toFixed(2);\r\n  };\r\n\r\n  const stripePromise = loadStripe(\r\n    \"pk_test_51Nj8vADRdzzh1Z4QYGEKVxQO12ZZFgATugRlwwZdyXIRiG2UpFsLIm09WcaDIWxmhYBZeYhkJLTrV0OT4yCd0EzN00BD6JwrFk\"\r\n  );\r\n\r\n  const handlePayment = async () => {\r\n    try {\r\n      const stripe = await stripePromise;\r\n      const res = await makeRequest.post(\"/orders\", {\r\n        products,\r\n      });\r\n      await stripe.redirectToCheckout({\r\n        sessionId: res.data.stripeSession.id,\r\n      });\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"total flex justify-between font-medium text-lg mb-5\">\r\n        <span>SUBTOTAL</span>\r\n        <span>${totalPrice()}</span>\r\n      </div>\r\n      <button\r\n        className=\"w-44 py-3 bg-blue-500 text-white  flex justify-center items-center gap-3 cursor-pointer font-medium text-xs mb-3 hover:bg-blue-600 duration-200\"\r\n        onClick={handlePayment}\r\n      >\r\n        PROCEED TO CHECKOUT\r\n      </button>\r\n      <span\r\n        className=\"reset text-red-500 text-xs cursor-pointer hover:text-red-600\"\r\n        onClick={() => dispatch(resetCart())}\r\n      >\r\n        Reset Cart\r\n      </span>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Payment;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}